{"name":"Rusha","tagline":"High-performance pure-javascript SHA1 implementation suitable for large binary data, reaching up to half the native speed.","body":"## Prologue: The Sad State of Javascript SHA1 implementations\r\n\r\nWhen we started experimenting with alternative upload technologies at [doctape](http://doctape.com) that required creating SHA1 hashes of the data locally on the client, it quickly became obvious that there were no performant pure-js implementations of SHA1 that worked correctly on binary data.\r\n\r\nJeff Mott's [CryptoJS](http://code.google.com/p/crypto-js/) and Brian Turek's [jsSHA](http://caligatio.github.com/jsSHA/) were both hash functions that worked correctly on ASCII strings of a small size, but didn't scale to large data and/or didn't work correctly with binary data.\r\n\r\n(On a sidenode, as of now Tim Caswell's [Cifre](http://github.com/openpeer/cifre) actually works with large binary data, as opposed to previously statet.)\r\n\r\nBy modifying Paul Johnston's [sha1.js](http://pajhome.org.uk/crypt/md5/sha1.html) slightly, it worked correctly on binary data but was unfortunately very slow, especially on V8. So a few days were invested on my side to implement a Johnston-inspired SHA1 hashing function with a heavy focus on performance.\r\n\r\nThe result of this process is Rusha, a SHA1 hash function that works flawlessly on large amounts binary data, such as binary strings or ArrayBuffers returned by the HTML5 File API, and leverages the soon-to-be-landed-in-firefox [asm.js](http://asmjs.org/spec/latest/) with whose support its within *half of native speed*!\r\n\r\n## Installing\r\n\r\n### Node.JS\r\n\r\nThere is really no point in doing this, since Node.JS already has a wonderful `crypto` module that is leveraging low-level hardware instructions to perform really nice. Your can see the comparison below in the benchmarks.\r\n\r\nRusha is available on [npm](http://npmjs.org/) via `npm install rusha`.\r\n\r\nIf you still want to do this, anyhow, just `require()` the `rusha.js` file, follow the instructions on _Using the Rusha Object_.\r\n\r\n### Browser\r\n\r\nRusha is available on [bower](http://twitter.github.com/bower/) via `bower install rusha`.\r\n\r\nIt is highly recommended to run CPU-intensive tasks in a [Web Worker](http://developer.mozilla.org/en-US/docs/DOM/Using_web_workers). To do so, just start a worker with `var worker = new Worker('rusha.js')` and start sending it jobs. Follow the instructions on _Using the Rusha Worker_.\r\n\r\nIf you can't, for any reason, use Web Workers, include the `rusha.js` file in a `<script>` tag and follow the instructions on _Using the Rusha Object_.\r\n\r\n## Using the Rusha Object\r\n\r\nYour instantiate a new Rusha object by doing `var r = new Rusha(optionalSizeHint)`. When created, it provides the following methods:\r\n\r\n- `Rusha#digestFromString(s)`: Create a hex digest from a binary `String`. A binary string is expected to only contain characters whose charCode < 256.\r\n- `Rusha#digestFromBuffer(b)`: Create a hex digest from a `Buffer` or `Array`. Both are expected to only contain elements < 256.\r\n- `Rusha#digestFromArrayBuffer(a)`: Create a hex digest from an `ArrayBuffer` object.\r\n\r\n## Using the Rusha Worker\r\n\r\nYou can send your instance of the web worker messages in the format `{id: jobid, data: dataobject}`. The worker then sends back a message in the format `{id: jobid, hash: hash}`, were jobid is the id of the job previously received and hash is the hash of the data-object you passed, be it a `Blob`, `Array`, `Buffer`, `ArrayBuffer` or `String`.\r\n\r\n## Benchmarks\r\n\r\nTested were my Rusha implementation, the sha1.js implementation by [P. A. Johnston](http://pajhome.org.uk/crypt/md5/sha1.html), Tim Caswell's [Cifre](http://github.com/openpeer/cifre) and the Node.JS native implementation.\r\n\r\nThe best results for each implementation:\r\n\r\n\t   4096 bytes: Native:  0ms, Rusha:  1ms, Johnston:   3ms, Cifre:    4ms\r\n\t1048576 bytes: Native:  4ms, Rusha: 11ms, Johnston:  55ms, Cifre:  150ms\r\n\t4194304 bytes: Native: 17ms, Rusha: 41ms, Johnston: 211ms, Cifre:  614ms\r\n\t8388608 bytes: Native: 37ms, Rusha: 80ms, Johnston: 428ms, Cifre: 1205ms\r\n\r\nAll tests were performed on a MacBook Air 1.7 GHz Intel Core i5 and 4 GB 1333 MHz DDR3. Detailed results below.\r\n\r\nFirefox Nightly (with asm.js support) 22.0a1:\r\n\r\n\tBenchmarking 4096 bytes ...\r\n\tNative   emitted unavailable in 0 milliseconds\r\n\tRusha    emitted e217ea942d68455677ca703baea41367ead7e912 in 1 milliseconds\r\n\tJohnst.  emitted e217ea942d68455677ca703baea41367ead7e912 in 3 milliseconds\r\n\tCifre    emitted e217ea942d68455677ca703baea41367ead7e912 in 5 milliseconds\r\n\tBenchmarking 1048576 bytes ...\r\n\tNative   emitted unavailable in 0 milliseconds\r\n\tRusha    emitted f39c96db473b722e6ecd0f429807588b198c931c in 11 milliseconds\r\n\tJohnst.  emitted f39c96db473b722e6ecd0f429807588b198c931c in 82 milliseconds\r\n\tCifre    emitted f39c96db473b722e6ecd0f429807588b198c931c in 183 milliseconds\r\n\tBenchmarking 4194304 bytes ...\r\n\tNative   emitted unavailable in 0 milliseconds\r\n\tRusha    emitted df59869d022e543d26fa9c80b78349c8c3a7372f in 41 milliseconds\r\n\tJohnst.  emitted df59869d022e543d26fa9c80b78349c8c3a7372f in 243 milliseconds\r\n\tCifre    emitted df59869d022e543d26fa9c80b78349c8c3a7372f in 633 milliseconds\r\n\tBenchmarking 8388608 bytes ...\r\n\tNative   emitted unavailable in 0 milliseconds\r\n\tRusha    emitted 709f1cdd1b69e3e692f92cd7aaeafa70bc3d93f1 in 80 milliseconds\r\n\tJohnst.  emitted 709f1cdd1b69e3e692f92cd7aaeafa70bc3d93f1 in 429 milliseconds\r\n\tCifre    emitted 709f1cdd1b69e3e692f92cd7aaeafa70bc3d93f1 in 1312 milliseconds\r\n\r\nNode (V8) 0.8.18:\r\n\r\n\tBenchmarking 4096 bytes ...\r\n\tNative   emitted 377322fdb03494521d8781c68ccad0be909bc39c in 0 milliseconds\r\n\tRusha    emitted 377322fdb03494521d8781c68ccad0be909bc39c in 4 milliseconds\r\n\tJohnst.  emitted 377322fdb03494521d8781c68ccad0be909bc39c in 3 milliseconds\r\n\tCifre    emitted 377322fdb03494521d8781c68ccad0be909bc39c in 9 milliseconds\r\n\tBenchmarking 1048576 bytes ...\r\n\tNative   emitted e7dcf18132f327aa3ff96198b10e733db2f7378e in 4 milliseconds\r\n\tRusha    emitted e7dcf18132f327aa3ff96198b10e733db2f7378e in 30 milliseconds\r\n\tJohnst.  emitted e7dcf18132f327aa3ff96198b10e733db2f7378e in 98 milliseconds\r\n\tCifre    emitted e7dcf18132f327aa3ff96198b10e733db2f7378e in 330 milliseconds\r\n\tBenchmarking 4194304 bytes ...\r\n\tNative   emitted d3c7af18250e3518eb961010c3d0d891c9431989 in 22 milliseconds\r\n\tRusha    emitted d3c7af18250e3518eb961010c3d0d891c9431989 in 119 milliseconds\r\n\tJohnst.  emitted d3c7af18250e3518eb961010c3d0d891c9431989 in 396 milliseconds\r\n\tCifre    emitted d3c7af18250e3518eb961010c3d0d891c9431989 in 1226 milliseconds\r\n\tBenchmarking 8388608 bytes ...\r\n\tNative   emitted ce99b2f0a3c4279bd5c33378ba83cc2569642053 in 34 milliseconds\r\n\tRusha    emitted ce99b2f0a3c4279bd5c33378ba83cc2569642053 in 226 milliseconds\r\n\tJohnst.  emitted ce99b2f0a3c4279bd5c33378ba83cc2569642053 in 702 milliseconds\r\n\tCifre    emitted ce99b2f0a3c4279bd5c33378ba83cc2569642053 in 2455 milliseconds\r\n\r\nChrome (V8) 25.0:\r\n\r\n\tBenchmarking 4096 bytes ...\r\n\tNative   emitted unavailable in 0 milliseconds\r\n\tRusha    emitted 2e69e5a3dcdf0b9a258656795e91219c8470157c in 6 milliseconds\r\n\tJohnst.  emitted 2e69e5a3dcdf0b9a258656795e91219c8470157c in 23 milliseconds\r\n\tCifre    emitted 2e69e5a3dcdf0b9a258656795e91219c8470157c in 9 milliseconds\r\n\tBenchmarking 1048576 bytes\r\n\tNative   emitted unavailable in 0 milliseconds\r\n\tRusha    emitted 7edd589e41d6182818039e2433c951e3a9aa4893 in 72 milliseconds\r\n\tJohnst.  emitted 7edd589e41d6182818039e2433c951e3a9aa4893 in 250 milliseconds\r\n\tCifre    emitted 7edd589e41d6182818039e2433c951e3a9aa4893 in 150 milliseconds\r\n\tBenchmarking 4194304 bytes ...\r\n\tNative   emitted unavailable in 0 milliseconds\r\n\tRusha    emitted 8ff4c621772029827b4b94326fe25fec257e3de4 in 242 milliseconds\r\n\tJohnst.  emitted 8ff4c621772029827b4b94326fe25fec257e3de4 in 993 milliseconds\r\n\tCifre    emitted 8ff4c621772029827b4b94326fe25fec257e3de4 in 614 milliseconds\r\n\tBenchmarking 8388608 bytes ...\r\n\tNative   emitted unavailable in 0 milliseconds\r\n\tRusha    emitted 112df4d0e15ff90ce11bf613191db3b190b318d6 in 470 milliseconds\r\n\tJohnst.  emitted 112df4d0e15ff90ce11bf613191db3b190b318d6 in 1960 milliseconds\r\n\tCifre    emitted 112df4d0e15ff90ce11bf613191db3b190b318d6 in 1205 milliseconds \r\n\r\nSafari 6.0.2:\r\n\r\n\tBenchmarking 4096 bytes ...\r\n\tNative   emitted unavailable in 0 milliseconds\r\n\tRusha    emitted f73e06fd363306d948f15c2c5b19250b620996be in 5 milliseconds\r\n\tJohnst.  emitted f73e06fd363306d948f15c2c5b19250b620996be in 34 milliseconds\r\n\tCifre    emitted f73e06fd363306d948f15c2c5b19250b620996be in 13 milliseconds\r\n\tBenchmarking 1048576 bytes ...\r\n\tNative   emitted unavailable in 0 milliseconds\r\n\tRusha    emitted 654bbffd41912d5e0deaefcf391c58e3150f94d0 in 937 milliseconds\r\n\tJohnst.  emitted 654bbffd41912d5e0deaefcf391c58e3150f94d0 in 7574 milliseconds\r\n\tCifre    emitted 654bbffd41912d5e0deaefcf391c58e3150f94d0 in 2817 milliseconds\r\n\tBenchmarking 4194304 bytes ...\r\n\tNative   emitted unavailable in 0 milliseconds\r\n\tRusha    emitted abdd60ca01aad6cb57d721857b63c6a3928a962b in 3795 milliseconds\r\n\tJohnst.  emitted abdd60ca01aad6cb57d721857b63c6a3928a962b in 31965 milliseconds\r\n\tCifre    emitted abdd60ca01aad6cb57d721857b63c6a3928a962b in 12899 milliseconds\r\n\tBenchmarking 8388608 bytes ...\r\n\tNative   emitted unavailable in 0 milliseconds\r\n\tRusha    emitted fd40b28b24fa98634a85db99e306bb4bd4580ec3 in 8189 milliseconds\r\n\tJohnst.  emitted fd40b28b24fa98634a85db99e306bb4bd4580ec3 in 70497 milliseconds\r\n\tCifre    emitted fd40b28b24fa98634a85db99e306bb4bd4580ec3 in 24996 milliseconds\r\n\r\nFirefox Aurora 21.0a2:\r\n\r\n\tBenchmarking 4096 bytes ...\r\n\tNative   emitted unavailable in 0 milliseconds\r\n\tRusha    emitted 349f713c66d8f88eaed58e087f9cc8b8c33bcecf in 2 milliseconds\r\n\tJohnst.  emitted 349f713c66d8f88eaed58e087f9cc8b8c33bcecf in 3 milliseconds\r\n\tCifre    emitted 349f713c66d8f88eaed58e087f9cc8b8c33bcecf in 4 milliseconds\r\n\tBenchmarking 1048576 bytes ...\r\n\tNative   emitted unavailable in 0 milliseconds\r\n\tRusha    emitted ebf9b8f7ab2ae5ddfe40887c5f0e5dbf88c889ab in 25 milliseconds\r\n\tJohnst.  emitted ebf9b8f7ab2ae5ddfe40887c5f0e5dbf88c889ab in 53 milliseconds\r\n\tCifre    emitted ebf9b8f7ab2ae5ddfe40887c5f0e5dbf88c889ab in 161 milliseconds\r\n\tBenchmarking 4194304 bytes ...\r\n\tNative   emitted unavailable in 0 milliseconds\r\n\tRusha    emitted 30fa929476b34564ed1b977d33cc331d55dd06b0 in 83 milliseconds\r\n\tJohnst.  emitted 30fa929476b34564ed1b977d33cc331d55dd06b0 in 210 milliseconds\r\n\tCifre    emitted 30fa929476b34564ed1b977d33cc331d55dd06b0 in 625 milliseconds\r\n\tBenchmarking 8388608 bytes ...\r\n\tNative   emitted unavailable in 0 milliseconds\r\n\tRusha    emitted bc6a87bb491ba6befdd0555fcf79775fa6df02d2 in 165 milliseconds\r\n\tJohnst.  emitted bc6a87bb491ba6befdd0555fcf79775fa6df02d2 in 451 milliseconds\r\n\tCifre    emitted bc6a87bb491ba6befdd0555fcf79775fa6df02d2 in 1256 milliseconds\r\n\r\nFirefox 19.0.2:\r\n\r\n\tBenchmarking 4096 bytes ...\r\n\tNative   emitted unavailable in 0 milliseconds\r\n\tRusha    emitted 631800fc7cce39400fd7d5bffbf421821fbcf066 in 3 milliseconds\r\n\tJohnst.  emitted 631800fc7cce39400fd7d5bffbf421821fbcf066 in 3 milliseconds\r\n\tCifre    emitted 631800fc7cce39400fd7d5bffbf421821fbcf066 in 4 milliseconds\r\n\tBenchmarking 1048576 bytes ...\r\n\tNative   emitted unavailable in 0 milliseconds\r\n\tRusha    emitted 80dd388d67a9ea4ac36dbbf9d58c59da8ec71132 in 73 milliseconds\r\n\tJohnst.  emitted 80dd388d67a9ea4ac36dbbf9d58c59da8ec71132 in 55 milliseconds\r\n\tCifre    emitted 80dd388d67a9ea4ac36dbbf9d58c59da8ec71132 in 181 milliseconds\r\n\tBenchmarking 4194304 bytes ...\r\n\tNative   emitted unavailable in 0 milliseconds\r\n\tRusha    emitted 03b651c3edec8c8f77a5302af0e44523e946b762 in 277 milliseconds\r\n\tJohnst.  emitted 03b651c3edec8c8f77a5302af0e44523e946b762 in 214 milliseconds\r\n\tCifre    emitted 03b651c3edec8c8f77a5302af0e44523e946b762 in 693 milliseconds\r\n\tBenchmarking 8388608 bytes ...\r\n\tNative   emitted unavailable in 0 milliseconds\r\n\tRusha    emitted 908803b41d10fb94d2e97c9c16533c954e21b53d in 553 milliseconds\r\n\tJohnst.  emitted 908803b41d10fb94d2e97c9c16533c954e21b53d in 419 milliseconds\r\n\tCifre    emitted 908803b41d10fb94d2e97c9c16533c954e21b53d in 1340 milliseconds","google":"UA-38007063-2","note":"Don't delete this file! It's used internally to help with page regeneration."}